{% if transcription.status == 'completed' and user.is_authenticated and user.is_superuser %}
<div class="px-6 py-6">
    <!-- Reprocess Option for Superusers -->
    <div class="text-center">
        <div class="mb-4">
            <p class="text-sm text-gray-600 mb-4">
                Want to re-analyze this music with the latest AI improvements?
                <br>This will generate a fresh transcription.
            </p>
        </div>
        <button type="button"
            class="inline-flex items-center px-6 py-3 bg-musical-gold hover:bg-yellow-500 text-black font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md"
            hx-post="{% url 'transcriber:reprocess' transcription.id %}" hx-target="#unified-status-card"
            hx-swap="outerHTML"
            hx-confirm="This will replace the current transcription. Are you sure you want to reprocess?">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
            Reprocess with Latest AI
        </button>
        <p class="text-xs text-gray-500 mt-2">
            This will take 2-3 minutes and replace current results
        </p>
    </div>
</div>
{% elif transcription.status == 'completed' and user.is_authenticated and transcription.user == user %}
<div class="px-6 py-6">
    <!-- Reprocess Option for Owner -->
    <div class="text-center">
        <div class="mb-4">
            <p class="text-sm text-gray-600 mb-4">
                Want to re-analyze your music with the latest AI improvements?
                <br>This will generate a fresh transcription.
            </p>
        </div>
        <button type="button"
            class="inline-flex items-center px-6 py-3 bg-musical-gold hover:bg-yellow-500 text-black font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md"
            hx-post="{% url 'transcriber:reprocess' transcription.id %}" hx-target="#unified-status-card"
            hx-swap="outerHTML"
            hx-confirm="This will replace your current transcription. Are you sure you want to reprocess?">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
            Reprocess with Latest AI
        </button>
        <p class="text-xs text-gray-500 mt-2">
            This will take 2-3 minutes and replace your current results
        </p>
    </div>
</div>
{% endif %}