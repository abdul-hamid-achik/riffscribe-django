<!-- Success message and refresh components after comment is added -->
<div class="mb-4 p-4 bg-green-50 border border-green-200 rounded-lg">
    <div class="flex items-center">
        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
        </svg>
        <span class="text-green-800 font-medium">Your comment has been posted successfully!</span>
    </div>
</div>

<!-- Fresh comment form based on user authentication -->
{% if user.is_authenticated %}
    {% include 'transcriber/partials/comment_form.html' with form=form transcription=transcription %}
{% else %}
    {% include 'transcriber/partials/anonymous_comment_form.html' with form=form transcription=transcription %}
{% endif %}

<!-- Trigger refresh of comments list -->
<script>
// Refresh the comments list to show the new comment
htmx.ajax('GET', '{% url 'transcriber:comments_list' transcription.pk %}', {
    target: '#comments-list',
    swap: 'innerHTML'
});
</script>